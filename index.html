<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Storia dell'Abisso - Album Albaz</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#020617">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:ital,wght@0,300;0,400;1,400&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Lato', sans-serif; 
            background-color: #020617; 
            overscroll-behavior-y: none; 
            overflow-x: hidden;
        }
        h1, h2, h3, .font-fantasy { font-family: 'Cinzel', serif; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes zoomOut { from { transform: scale(1); opacity: 1; } to { transform: scale(0.8); opacity: 0; } }
        
        .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; }
        .animate-slideUp { animation: slideUp 0.5s ease-out forwards; }
        .animate-zoomIn { animation: zoomIn 0.3s ease-out forwards; }
        .animate-zoomOut { animation: zoomOut 0.3s ease-out forwards; }
        
        .anim-enter-right { animation: slideInRight 0.2s forwards ease-out; }
        .anim-enter-left { animation: slideInLeft 0.2s forwards ease-out; }
        .anim-exit-left { animation: slideOutLeft 0.2s forwards ease-in; }
        .anim-exit-right { animation: slideOutRight 0.2s forwards ease-in; }

        @keyframes slideInRight { 
            from { opacity: 0; transform: translateX(50px); } 
            to { opacity: 1; transform: translateX(0); } 
        }
        @keyframes slideInLeft { 
            from { opacity: 0; transform: translateX(-50px); } 
            to { opacity: 1; transform: translateX(0); } 
        }
        @keyframes slideOutLeft { 
            from { opacity: 1; transform: translateX(0); } 
            to { opacity: 0; transform: translateX(-50px); } 
        }
        @keyframes slideOutRight { 
            from { opacity: 1; transform: translateX(0); } 
            to { opacity: 0; transform: translateX(50px); } 
        }
        
        .card-glow:hover, .card-glow:active {
            box-shadow: 0 0 15px rgba(234, 179, 8, 0.5);
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="text-slate-200 antialiased selection:bg-yellow-900 selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const getHighResUrl = (url) => {
            if (!url) return '';
            if (url.includes('glide')) return url;
            return url.replace('cards_small', 'cards');
        };

        const getYoutubeId = (url) => {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        };

        const getYoutubeThumbnail = (id) => `https://img.youtube.com/vi/${id}/mqdefault.jpg`;

        const Icons = {
            Book: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth="1.5" stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" /></svg>,
            Back: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7" /></svg>,
            Close: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" /></svg>,
            Sparkles: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" /></svg>,
            Prev: () => <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7" /></svg>,
            Next: () => <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 5l7 7-7 7" /></svg>,
            ZoomIn: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7" /></svg>,
            Eye: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>,
            EyeOff: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" /></svg>,
            Download: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>,
            Video: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            Play: () => <svg className="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>,
            Tv: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth="1.5" stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M6 20.25h12m-7.5-3v3m3-3v3m-10.125-3h17.25c.621 0 1.125-.504 1.125-1.125V4.875c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125Z" /></svg>
        };

        const chaptersData = [
            { 
                id: 1, 
                title: "Atto I", 
                fullTitle: "Atto I: Il Dogma dell'Abisso", 
                cover: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/2zPzzSTjYneNQK40rjkF/pub/D6Hqrqx0o2YXmtmWjDoK.jpg", 
                story: `Ciò che il Cardinale ha portato alla luce erano i resti di un'antica prosperità.\n\nSarà un Vangelo, o forse una Maledizione?\n\nLe braci diventeranno la scintilla che illuminerà \nla terra ancora una volta.\n\nI Cavalieri dei Sacri Insegnamenti preparano le loro spade,\nMentre le Bestie di Ferro caricano e puntano le armi.\n\nE poi, il Giovane incontra la Fanciulla.\n\nQui, i cancelli dell'Abisso stanno per aprirsi.`,
                videos: [
                    { title: "The Fallen & The Virtuous I: Dogmatika Ecclesia, the Virtuous", url: "https://www.youtube.com/watch?v=hY359iE59Bg" },
                    { title: "The Fallen & The Virtuous II: Dogmatika Fleurdelis, the Knighted", url: "https://www.youtube.com/watch?v=RDMPbSTRG7I" },
                    { title: "The Fallen & The Virtuous III: Tri-Brigade Shuraig the Ominous Omen", url: "https://www.youtube.com/watch?v=-nKp2XbUPNE" }
                ]
            },
            { 
                id: 2, 
                title: "Atto II", 
                fullTitle: "Atto II: L'Esilio", 
                cover: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/2zPzzSTjYneNQK40rjkF/pub/57nlVHrKACfQFgfkYfb8.jpg", 
                story: `Una tempesta di tragicommedia scoppia nell'Abisso.\n\nUna breve avventura,\neppure l'ombra di un artificio giace oltre il velo.\n\nNascosta tra le quinte del palco, risuona una melodia di amore e odio.\n\nNelle profondità del Vuoto, la disperazione si contorce.\n\nIl destino irradia una luce misteriosa sui Despia.\n\nQui, il sipario del Dramma della Malvagità si alza.`,
                videos: [
                    { title: "The Fallen & The Virtuous IV: Fallen of Albaz", url: "https://www.youtube.com/watch?v=R5Np42rXaXc" },
                    { title: "The Fallen & The Virtuous V: Tri-Brigade Kitt", url: "https://www.youtube.com/watch?v=M_aCXrs1fLI" }
                ]
            },
            { 
                id: 3, 
                title: "Atto III", 
                fullTitle: "Atto III: Ghiaccio e Fiamme", 
                cover: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/2zPzzSTjYneNQK40rjkF/pub/Uz2f7ZaEl8UmkUD9zMJB.jpg", 
                story: `Guardiani della Sacra Vetta.\n\nPer rispondere ai loro voti, un Drago di Spade, \navvolto da fiamme di ghiaccio.\n\nCiononostante, la farsa non cessa.\n\nIl Giullare della divinità ghigna nel cielo.\n\nL'innocente Fanciulla Sacra si tinge di rosso.\n\nQui, il grido del drago non può raggiungerla.`,
                videos: [
                    { title: "The Fallen & The Virtuous VI: Albion the Branded Dragon", url: "https://www.youtube.com/watch?v=kOP1i4baEmk" }
                ]
            },
            { 
                id: 4, 
                title: "Atto IV", 
                fullTitle: "Atto IV: Un Nuovo Potere", 
                cover: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/2zPzzSTjYneNQK40rjkF/pub/tLANROn4SOhFLpTBwGj2.jpg", 
                story: `Fiamme eruttanti e tuono ruggente: La Nazione di Ferro.\n\nNel circolo dei potenti, egli resta in vetta.\n\nLa sua ragione per resistere: \nper il bene dei suoi amici.\n\nCiò che suona e risuona: la campana del Dio.\n\nORA TUTTI VOI, CON TUTTO QUELLO CHE AVETE!\nANDATE, ANDATE, SARGAS!\nSPINGETE, SPINGETE, SARGAS!`,
                videos: [],
                comingSoon: true
            },
            { 
                id: 5, 
                title: "Atto V", 
                fullTitle: "Atto V: La Resa dei Conti", 
                cover: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/2zPzzSTjYneNQK40rjkF/pub/ZSO8AcUTaHR9fp6v3PQi.jpg", 
                story: `Fiamme fragili ma connesse danzano sulle rovine.\n\nFugaci, eppure ardentemente risplendenti,\nsaranno la luce che splenderà sulle ombre cadute.\n\nEvocando il Tuono Ardente, l'Ala di Ferro, la Spada del Vero Aspetto,\nle Fiamme del Re.\n\nE poi, il ritrovo del Giovane e della Fanciulla.\n\nQui, la Terra delle Vere Fiamme sta per aprirsi.`,
                videos: [],
                comingSoon: true
            }
        ];

        const cardsData = [
            // ATTO I
            { name: "Nazione Dogmatika", image: "https://images.ygoprodeck.com/images/cards/65589010.jpg", chapterId: 1, lore: "In una terra segnata dalle Voragini dell'Abisso, sorge una fortezza di luce bianca. Qui la purezza è legge assoluta, e ogni dissenso è un peccato mortale." },
            { name: "Dogmatika Nexus", image: "https://images.ygoprodeck.com/images/cards/22073844.jpg", chapterId: 1, lore: "L'antico reliquiario che alimenta il potere sacro della Nazione Dogmatika, oltre al suo più grande segreto." },
            { name: "Dogmatika Maximus", image: "https://images.ygoprodeck.com/images/cards/95679145.jpg", chapterId: 1, lore: "La voce dell'Autorità Suprema non ammette rifiuti. Un pastore che guida il suo gregge con falsi sorrisi gelidi e col pugno di ferro." },
            { name: "Dogmatika Theo, il Pugno di Ferro", image: "https://images.ygoprodeck.com/images/cards/96891787.jpg", chapterId: 1, lore: "La forza bruta al servizio della dottrina. Il suo scopo è obbedire, senza fare domande." },
            { name: "Dogmatika Adin, l'Illuminato", image: "https://images.ygoprodeck.com/images/cards/33296432.jpg", chapterId: 1, lore: "L'intelletto piegato al Dogma. La sua conoscenza potrebbe far vacillare le fondamenta della Fede." },
            { name: "Dogmatika Ecclesia, la Virtuosa", image: "https://images.ygoprodeck.com/images/cards/60303688.jpg", chapterId: 1, lore: "La Fede l'ha tradita. Spogliata del marchio e ripudiata dai suoi stessi compagni, la Virtuosa sceglie la via più difficile: quella della verità." },
            { name: "Dogmatika Fleurdelis, il Nominato Cavaliere", image: "https://images.ygoprodeck.com/images/cards/69680031.jpg", chapterId: 1, lore: "L'acciaio sacro non trema mai. Lei è il braccio armato della Chiesa, nonché tutrice della giovane Ecclesia. Una tempesta di fulmini pronta a incenerire l'eresia." },
            { name: "Servitore Nadir", image: "https://images.ygoprodeck.com/images/cards/1984618.jpg", chapterId: 1, lore: "Uno squarcio che spezza il cielo. I destini di un Drago caduto e di una giovane ragazza si incrociano per la prima volta, ignorando che il mondo sta per cambiare per sempre." },
            { name: "Titaniklad il Drago di Cenere", image: "https://images.ygoprodeck.com/images/cards/41373230.jpg", chapterId: 1, lore: "Il drago della cenere, disceso nell'ora del Grande Vangelo. La sua apparizione è il presagio di un'Apocalisse imminente." },
            { name: "Punizione Dogmatika", image: "https://images.ygoprodeck.com/images/cards/82956214.jpg", chapterId: 1, lore: "Il giudizio cala rapido e spietato. Non c'è pietà per la bestia che osa profanare il suolo sacro: solo il tuono della giustizia divina." },
            { name: "Caduto di Albaz", image: "https://images.ygoprodeck.com/images/cards/68468459.jpg", chapterId: 1, lore: "Tra la polvere e il sangue, la bestia rivela la sua verità: non un mostro, ma un ragazzo smarrito, privo di memoria e marchiato dall'oscurità." },
            { name: "Incontro Dogmatika", image: "https://images.ygoprodeck.com/images/cards/29354228.jpg", chapterId: 1, lore: "Un gesto proibito che sfida la Dottrina. Dove l'Impero vede un nemico da abbattere, Ecclesia vede solo un'anima da salvare." },
            { name: "Tri-Brigata Rugal la Pallottola d'Argento", image: "https://images.ygoprodeck.com/images/cards/52331012.jpg", chapterId: 1, lore: "L'indomito guerriero delle retrovie, la cui armatura d'argento scaglia dardi di vendetta contro la tirannia della Chiesa." },
            { name: "Tri-Brigata Shuraig il Sinistro Presagio", image: "https://images.ygoprodeck.com/images/cards/99726621.jpg", chapterId: 1, lore: "Leader della resistenza. Accoglie i due fuggiaschi sulla sua nave, sfidando apertamente l'esercito sacro." },
            { name: "Spinta Tattiche Triple", image: "https://www.nakijo.com.au/cdn/shop/files/30_3c26184c-b138-4842-a245-450c049b450a_720x.jpg?v=1761120272", chapterId: 1, lore: "Nel caos della battaglia, una mossa a sorpresa può cambiare il corso della storia, ribaltando il destino." },
            { name: "Tri-Brigata Nervall", image: "https://images.ygoprodeck.com/images/cards/14816857.jpg", chapterId: 1, lore: "Il messaggero alato che annuncia la guerra e lega i destini dei fuorilegge." },
            { name: "Tri-Brigata Kerass", image: "https://images.ygoprodeck.com/images/cards/50810455.jpg", chapterId: 1, lore: "Un agile combattente terrestre, pronto a sacrificarsi per la libertà della sua tribù." },
            { name: "Tri-Brigata Fraktall", image: "https://images.ygoprodeck.com/images/cards/87209160.jpg", chapterId: 1, lore: "L'esploratore che traccia i percorsi dell'esilio, portando notizie e speranza ai popoli oppressi." },
            { name: "Assalto Aereo Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards/51097887.jpg", chapterId: 1, lore: "I ribelli si lanciano dall'alto, rompendo le linee nemiche con un assalto aereo audace." },
            { name: "Dogmatika Ashiyan", image: "https://images.ygoprodeck.com/images/cards/13694209.jpg", chapterId: 1, lore: "L'assassino della fede. L'ombra di Maximus che porta l'Eresia al patibolo." },
            { name: "Stallo Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards/25908748.jpg", chapterId: 1, lore: "Fucili puntati pronti a far fuoco. Due fuggitivi circondati da chi ha fatto della sopravvivenza la propria unica legge." },
            { name: "Dogmatikacismo", image: "https://images.ygoprodeck.com/images/cards/87481592.jpg", chapterId: 1, lore: "Quando la paura prende il sopravvento sul cuore, la 'Santa' viene strappata al suo potere sacro e condannata all'esilio come 'Eretica'." },
            { name: "Il Drago che Divora il Dogma", image: "https://images.ygoprodeck.com/images/cards/76666602.jpg", chapterId: 1, lore: "Un presagio di distruzione, la cui bocca è un buco verso il vuoto che annienta la volontà divina." },
            { name: "Brigrand il Drago Glorioso", image: "https://images.ygoprodeck.com/images/cards/34848821.jpg", chapterId: 1, lore: "La prima vera trasformazione di Albaz, un drago nato da un primo vero sentimento di amore." },
            { name: "Rivolta Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards/40975243.jpg", chapterId: 1, lore: "L'ultima risorsa dei fuorilegge. Un ruggito collettivo che riporta fiducia tra le fila dei ribelli." },
            { name: "Giuramento Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards/86379342.jpg", chapterId: 1, lore: "Non serve il sangue per essere fratelli. Un uccello meccanico suggella un patto tra reietti: d'ora in poi, nessuno combatterà più da solo." },
            // ATTO II
            { name: "Albaz l'Ammantato", image: "https://www.cardtrader.com/uploads/blueprints/image/208217/show_albaz-the-shrouded-structure-deck-albaz-strike.jpg", chapterId: 2, lore: "Il ragazzo avvolto dal mistero. La sua forza, ancora velata, lo destina a un grande futuro o a una tragedia oscura." },
            { name: "Ecclesia l'Esiliata", image: "https://www.cardtrader.com/uploads/blueprints/image/208218/show_ecclesia-the-exiled-structure-deck-albaz-strike.jpg", chapterId: 2, lore: "Il cammino della Virtuosa è senza scorta, tranne la sua fede nel Caduto. La sua armatura è sporca di sabbia, non di dogma." },
            { name: "Grande Mare di Sabbia - Gold Golgonda", image: "https://images.ygoprodeck.com/images/cards/60884672.jpg", chapterId: 2, lore: "Un oceano di polvere dorata dove i resti dei giganti antichi dormono un sonno eterno, nascondendo tesori e minacce." },
            { name: "Osservazione Springans", image: "https://images.ygoprodeck.com/images/cards/23499963.jpg", chapterId: 2, lore: "Occhietti luminosi spiano oltre le dune. Il mondo degli Springans è un mosaico di rottami, ingegno e segreti." },
            { name: "Springans Capitano Sargas", image: "https://images.ygoprodeck.com/images/cards/29601381.jpg", chapterId: 2, lore: "Il Capitano dei pirati del deserto. La sua grossa armatura nasconde un cuore pronto ad accogliere i disperati." },
            { name: "Nave Springans - Exblowrer", image: "https://images.ygoprodeck.com/images/cards/62941499.jpg", chapterId: 2, lore: "La nave ammiraglia, pesante e potente, che solca il deserto come un mare d'oro, portando rovina ai nemici." },
            { name: "Springans Rockey", image: "https://images.ygoprodeck.com/images/cards/20424878.jpg", chapterId: 2, lore: "Uno dei piccoli spiriti, coraggioso e impulsivo, pioniere della prossima grande avventura." },
            { name: "Springans Pedor", image: "https://images.ygoprodeck.com/images/cards/56818977.jpg", chapterId: 2, lore: "Con la sua palla esplosiva, questo spirito di fuliggine è più pericoloso di quanto sembri." },
            { name: "Springans Branga", image: "https://images.ygoprodeck.com/images/cards/83203672.jpg", chapterId: 2, lore: "Il braccio destro del Capitano, sempre pronto all'azione con le sue potenti macchine." },
            { name: "Tri-Brigata Kitt", image: "https://images.ygoprodeck.com/images/cards/56196385.jpg", chapterId: 2, lore: "Il genio meccanico in un mondo di ruggine. Con lei ogni sfida per la sopravvivenza diventa un'avventura." },
            { name: "Incontro Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards/96378317.jpg", chapterId: 2, lore: "Un incontro particolare segna una nuova alleanza. Gli Springans, in accordo con la Tri-Brigata, offrono un faro nel buio a coloro che devono fuggire." },
            { name: "Richiamo Springans!", image: "https://images.ygoprodeck.com/images/cards/83199011.jpg", chapterId: 2, lore: "L'adunata! Un grido nel deserto mobilita i cacciatori di tesori per difendere i nuovi amici." },
            { name: "Springans Fratelli", image: "https://images.ygoprodeck.com/images/cards/67436768.jpg", chapterId: 2, lore: "L'unità fa la forza. Due piccoli amici si uniscono per lanciare la loro fantasiosa, ma efficace, offensiva." },
            { name: "Sprind il Drago Ferrocorsa", image: "https://images.ygoprodeck.com/images/cards/1906812.jpg", chapterId: 2, lore: "Carne e metallo si fondono in un ruggito di motori. Il ragazzo accetta il dono della tecnologia per proteggere i suoi nuovi alleati." },
            { name: "Esplosione Springans!", image: "https://images.ygoprodeck.com/images/cards/10584050.jpg", chapterId: 2, lore: "L'esplosione! Un proiettile di energia Springans rompe l'accerchiamento e protegge i fuggitivi." },
            { name: "Springans Festaioli", image: "https://images.ygoprodeck.com/images/cards/48285768.jpg", chapterId: 2, lore: "Il maestro della festa. Un fuoco d'artificio di energia inebriante che maschera il dolore e celebra la libertà." },
            { name: "Bottino Springans", image: "https://images.ygoprodeck.com/images/cards/7496001.jpg", chapterId: 2, lore: "Tra le dune, piccole scintille di gioia. Macchine arrugginite e spiriti di fuliggine accolgono i viaggiatori con il caos di una famiglia stravagante." },
            { name: "Genesi Dogmatika", image: "https://images.ygoprodeck.com/images/cards/56588755.jpg", chapterId: 2, lore: "Il velo si squarcia e la verità oscura viene rivelata: il dogma è solo il primo atto di una liturgia più antica." },
            { name: "Dogmatikalamità", image: "https://images.ygoprodeck.com/images/cards/31002402.jpg", chapterId: 2, lore: "Il sipario si alza. La capitale sacra viene inghiottita da fiamme rosse e follia. Nasce il regno di Dispia." },
            { name: "Dispia, Teatro dei Marchiati", image: "https://images.ygoprodeck.com/images/cards/99543666.jpg", chapterId: 2, lore: "La Città Santa muore, il Teatro degli Orrori nasce. Le guglie diventano ossa, la preghiera diventa urlo: il palcoscenico è pronto per l'atto finale." },
            { name: "Cavaliere Bianco della Dogmatika", image: "https://images.ygoprodeck.com/images/cards/40352445.jpg", chapterId: 2, lore: "Fleurdelis un tempo l'aveva indossata. La sua armatura, ormai vuota, trova nell'oscurità il suo nuovo padrone." },
            { name: "Commedia Dispia", image: "https://images.ygoprodeck.com/images/cards/90179822.jpg", chapterId: 2, lore: "Una risata isterica e grottesca. La Commedia gioca con le tragedie umane come in una farsa senza fine." },
            { name: "Aluber il Giullare di Dispia", image: "https://images.ygoprodeck.com/images/cards/62962630.jpg", chapterId: 2, lore: "Lo specchio si infrange rivelando un riflesso distorto. Un sorriso crudele emerge dall'ombra, pronto a trasformare la guerra in una tragedia teatrale." },
            { name: "Tragedia Dispia", image: "https://images.ygoprodeck.com/images/cards/36577931.jpg", chapterId: 2, lore: "Il primo atto dell'opera. Una maschera piangente che nasconde secoli di sofferenza orchestrata." },
            { name: "Ad Libitum di Dispia", image: "https://images.ygoprodeck.com/images/cards/81555617.jpg", chapterId: 2, lore: "Il re corrotto che osserva il massacro dal suo trono, godendo della sofferenza del suo popolo." },
            // ATTO III
            { name: "Drammaturgo di Dispia", image: "https://images.ygoprodeck.com/images/cards/99456344.jpg", chapterId: 3, lore: "Il generale dell'armata infernale. Un tempo era un cardinale, ora è un mostro che si nutre di tragedia." },
            { name: "Proskenion Dispiano", image: "https://images.ygoprodeck.com/images/cards/18666161.jpg", chapterId: 3, lore: "L'ingresso del teatro. Un portale cremisi che vomita orrori sull'innocenza del mondo." },
            { name: "Quaeritis Dispiano", image: "https://images.ygoprodeck.com/images/cards/72272462.jpg", chapterId: 3, lore: "La vera forma contorta del Cavaliere Bianco. Un guscio vuoto animato da anime urlanti." },
            { name: "Marchiato in Rosso", image: "https://images.ygoprodeck.com/images/cards/82738008.jpg", chapterId: 3, lore: "Il cielo sanguina. La fusione proibita scatena il Drago Cremisi, e la disperazione cala sul campo di battaglia come un sudario." },
            { name: "Masquerade il Drago Fiammeggiante", image: "https://images.ygoprodeck.com/images/cards/6855503.jpg", chapterId: 3, lore: "Un drago di fuoco vivo che incenerisce ogni speranza. L'incarnazione della festa macabra di Aluber." },
            { name: "Apertura Marchiata", image: "https://images.ygoprodeck.com/images/cards/36637374.jpg", chapterId: 3, lore: "Il sipario si apre su una nuova scena: l'inizio dell'invasione Despia, un invito a salire sul palco della follia." },
            { name: "Supremo Sovrano Serpente di Golgonda", image: "https://images.ygoprodeck.com/images/cards/31042659.jpg", chapterId: 3, lore: "Il gigante addormentato del deserto, risvegliato per diventare un'arma letale nelle mani di Despia." },
            { name: "Marchiato in Bianco", image: "https://images.ygoprodeck.com/images/cards/34995106.jpg", chapterId: 3, lore: "Una fusione pura che illumina il drago caduto. Un tentativo disperato di trovare la luce nell'oscurità." },
            { name: "Albion il Drago Marchiato", image: "https://images.ygoprodeck.com/images/cards/87746184.jpg", chapterId: 3, lore: "La forma più potente del Drago di Albaz, priva di senno. Una figura imponente avvolta dalle fiamme bianche." },
            { name: "Urla del Marchiato", image: "https://images.ygoprodeck.com/images/cards/67100549.jpg", chapterId: 3, lore: "Il grido di dolore di un'anima tormentata. Il suo unico obiettivo è quello di eliminare chiunque sul suo cammino." },
            { name: "Giudizio del Marchiato", image: "https://images.ygoprodeck.com/images/cards/93595154.jpg", chapterId: 3, lore: "La furia incontrollata di Albion viene frenata da un fulmine amico che segna la fine per la mostruosa Creatura del deserto." },
            { name: "Interludiatore Springans", image: "https://images.ygoprodeck.com/images/cards/25415161.jpg", chapterId: 3, lore: "Un aiuto inaspettato che riporta la speranza. Tre misteriosi guerrieri avvolti da una luce scintillante." },
            { name: "L'Iris Spadanima", image: "https://images.ygoprodeck.com/images/cards/62849088.jpg", chapterId: 3, lore: "Una guerriera solitaria che cerca vendetta per i suoi compagni caduti e per la perdita del suo onore. La Fede non le appartiene più, ma conserva la potenza del Fulmine." },
            { name: "La Dorata Spadanima", image: "https://images.ygoprodeck.com/images/cards/82489470.jpg", chapterId: 3, lore: "Alleati disposti a morire per difendere la guerriera." },
            { name: "Legame Marchiato", image: "https://images.ygoprodeck.com/images/cards/62022479.jpg", chapterId: 3, lore: "Un legame indissolubile tra drago e umano, rafforzato dalla lealtà e dal cammino condiviso." },
            { name: "Albion il Drago Ammantato", image: "https://images.ygoprodeck.com/images/cards/25451383.jpg", chapterId: 3, lore: "Albaz riemerge dall'ombra della sofferenza, più forte e deciso a proteggere la sua amata. Gli spettri del suo passato però non l'hanno abbandonato." },
            { name: "Incredibile Ecclesia, la Virtuosa", image: "https://images.ygoprodeck.com/images/cards/55273560.jpg", chapterId: 3, lore: "Ha abbandonato le vesti sacre. Ora impugna un martello gigante, determinata a proteggere Albaz con le sue forze." },
            { name: "Tri-Brigata Bearbrumm la Sfrenata Furiosa", image: "https://images.ygoprodeck.com/images/cards/47163170.jpg", chapterId: 3, lore: "L'orgoglio della resistenza. L'ingegno che va oltre ogni ostacolo sulla via della libertà." },
            { name: "Marchiato nel Buonumore", image: "https://images.ygoprodeck.com/images/cards/29948294.jpg", chapterId: 3, lore: "La felicità descrive attimi intensi di gioia e speranza. La quiete prima della tempesta.." },
            { name: "Spadanima di Taia", image: "https://images.ygoprodeck.com/images/cards/56495147.jpg", chapterId: 3, lore: "L'apprendista guerriero degli Spadanima. La sua abilità con la spada è la prova che la tradizione resiste." },
            { name: "Spadanima di Mo Ye", image: "https://images.ygoprodeck.com/images/cards/20001443.jpg", chapterId: 3, lore: "Guerriera spirituale dell'Est. La sua spada è limpida come l'acqua. Insegna ad Albaz la disciplina." },
            { name: "Spadanima Stratega Longyuan", image: "https://images.ygoprodeck.com/images/cards/93490856.jpg", chapterId: 3, lore: "Il traditore. Vende la sua anima ad Aluber per ottenere più potere, pugnalando i suoi alleati alle spalle." },
            { name: "Spadanima Propizia Chunjun", image: "https://images.ygoprodeck.com/images/cards/29884951.jpg", chapterId: 3, lore: "Il presagio positivo degli Spadanima. Un segno di speranza e alleanza per Albaz ed Ecclesia." },
            { name: "Regnante Supremo Spadanima - Chengying", image: "https://images.ygoprodeck.com/images/cards/96633955.jpg", chapterId: 3, lore: "Immobile come la montagna, antico come il mondo. Il Gran Duca osserva i visitatori, giudicando il peso dei loro cuori." },
            { name: "Granmaestro Spadanima - Chixiao", image: "https://images.ygoprodeck.com/images/cards/69248256.jpg", chapterId: 3, lore: "Il saggio leader che accetta di aiutare i viaggiatori, percependo la bontà nel cuore del drago." },
            { name: "Comparsa Spadanima", image: "https://images.ygoprodeck.com/images/cards/56465981.jpg", chapterId: 3, lore: "Il sangue è versato. Il tradimento ha avuto successo e la vetta è in fiamme." },
            { name: "Sommità Sacra Spadanima", image: "https://images.ygoprodeck.com/images/cards/93850690.jpg", chapterId: 3, lore: "Dove le cascate sfidano il cielo e le anime diventano lame. Un santuario mistico sospeso tra le nuvole, custode di poteri dimenticati." },
            { name: "Valutazione Spadanima", image: "https://images.ygoprodeck.com/images/cards/78836195.jpg", chapterId: 3, lore: "Una valutazione del vero potenziale di Albaz e della sua purezza, un atto di fiducia rafforzato dopo un terribile tradimento." },
            { name: "Ghiacciogiada Acti", image: "https://images.ygoprodeck.com/images/cards/82777208.jpg", chapterId: 3, lore: "Una delle giovani guardiane di cristallo, custode della culla acquatica." },
            { name: "Ghiacciogiada Tinola", image: "https://images.ygoprodeck.com/images/cards/28762303.jpg", chapterId: 3, lore: "Silenziosa e vigile, è la sentinella dei segreti della nazione Ghiacciogiada, situata alle pendici della grande Vetta di Spadanima." },
            { name: "Ghiacciogiada Tremora", image: "https://images.ygoprodeck.com/images/cards/55151012.jpg", chapterId: 3, lore: "La Sacerdotessa dell'Acqua, che osserva gli eventi da lontano e sigilla le Stimmate dei fuggitivi." },
            { name: "Ghiacciogiada Aegirine", image: "https://images.ygoprodeck.com/images/cards/39354437.jpg", chapterId: 3, lore: "La principessa del gelo. Il suo dolore per la perdita la spingerà a diventare la prossima regina." },
            { name: "Ghiacciogiada Kosmochlor", image: "https://images.ygoprodeck.com/images/cards/3355732.jpg", chapterId: 3, lore: "La Regina del Ghiaccio. Si sacrifica per fermare le fiamme, donando il suo potere ad Albaz." },
            { name: "Ghiacciogiada Creazione Martin Pescatore", image: "https://images.ygoprodeck.com/images/cards/66749546.jpg", chapterId: 3, lore: "Un drago di cristallo nato per difendere l'innocenza, creato dal potere morente di Kosmochlor." },
            { name: "Culla Ghiacciogiada", image: "https://images.ygoprodeck.com/images/cards/55343303.jpg", chapterId: 3, lore: "Un luogo di riposo e guarigione. Il santuario dove Ecclesia e Albaz trovano una breve tregua." },
            { name: "Culla Enion Cenote Ghiacciogiada", image: "https://images.ygoprodeck.com/images/cards/7142724.jpg", chapterId: 3, lore: "Un silenzio di cristallo nel cuore del caos. L'ultima lacrima di un mondo morente offre rifugio a chi ha perso tutto." },
            { name: "Blackout Spadanima", image: "https://images.ygoprodeck.com/images/cards/14821890.jpg", chapterId: 3, lore: "Il veleno dell'ambizione corrompe anche l'acciaio più puro. Nell'ombra, un patto scellerato viene siglato per rovesciare l'ordine naturale." },
            { name: "Erosione Ghiacciogiada", image: "https://images.ygoprodeck.com/images/cards/53742162.jpg", chapterId: 3, lore: "La bellezza si infrange per proteggere la vita. Un sacrificio scintillante che si dissolve nella nebbia, lasciando in eredità la forza di combattere." },
            { name: "Regnante Sinistro Spadanima - Qixing Longyuan", image: "https://images.ygoprodeck.com/images/cards/47710198.jpg", chapterId: 3, lore: "Il tradimento divampa in fiamme nere. L'onore viene incenerito dall'invidia, e la spada sacra si macchia del sangue dei fratelli." },
            { name: "Reliquia Bianca della Dogmatika", image: "https://images.ygoprodeck.com/images/cards/48654323.jpg", chapterId: 3, lore: "L'essenza spettrale della fede Dogmatika, rianimata dai Despia per servire i loro scopi teatrali." },
            { name: "Conflitto Spadanima", image: "https://images.ygoprodeck.com/images/cards/99137266.jpg", chapterId: 3, lore: "La battaglia infuria sul picco, mentre i guerrieri Spadanima lottano disperatamente per la loro casa." },
            { name: "Discepolo Marchiato", image: "https://images.ygoprodeck.com/images/cards/34536828.jpg", chapterId: 3, lore: "Un seguace cieco del Marchio. La sua vita è dedicata al servire Aluber e il suo tragico spettacolo." },
            { name: "Aluber il Dogmatico", image: "https://www.cardtrader.com/uploads/blueprints/image/208221/show_aluber-the-dogmatic-structure-deck-albaz-strike.jpg", chapterId: 3, lore: "Dopo la corruzione, Aluber si presenta come il vero erede della dottrina, un giullare al comando del Dogma." },
            { name: "Perduto Marchiato", image: "https://images.ygoprodeck.com/images/cards/18973184.jpg", chapterId: 3, lore: "Il tradimento ha successo. Gli eroi si perdono nel caos, e la verità del Marchio viene dimenticata." },
            { name: "Dogmatikamacabra", image: "https://images.ygoprodeck.com/images/cards/60921537.jpg", chapterId: 3, lore: "La danza della morte nel Teatro Despia. Le marionette obbediscono al comando del Drammaturgo." },
            { name: "Punizione Marchiata", image: "https://images.ygoprodeck.com/images/cards/17751597.jpg", chapterId: 3, lore: "Un ultimo assalto disperato della coraggiosa guerriera, un tempo nota come Cavaliere Bianco." },
            { name: "Bando Marchiato", image: "https://images.ygoprodeck.com/images/cards/6763530.jpg", chapterId: 3, lore: "Un esilio forzato. Le forze di Despia strappano l'anima dal corpo della guerriera, scaraventandola in un Abisso senza tempo." },
            { name: "Maledizione Ghiacciogiada", image: "https://images.ygoprodeck.com/images/cards/83670388.jpg", chapterId: 3, lore: "Frammenti di un passato doloroso. La Regina si sgretola in polvere e il ghiaccio maledetto si abbatte sui traditori." },
            { name: "Spada Marchiata", image: "https://images.ygoprodeck.com/images/cards/81767888.jpg", chapterId: 3, lore: "La lama forgiata dal fuoco e dal ghiaccio che Albaz ha dovuto impugnare per combattere il suo lato oscuro." },
            { name: "Mirrorjade il Drago Lamaghiaccio", image: "https://images.ygoprodeck.com/images/cards/44146295.jpg", chapterId: 3, lore: "Forgiato dal dolore, temprato dal ghiaccio. La somma di ogni perdita diventa una lama capace di congelare persino l'odio." },
            { name: "Lubellion il Drago Ardente", image: "https://images.ygoprodeck.com/images/cards/70534340.jpg", chapterId: 3, lore: "La vera forma di Drago di Aluber. Un drago fiammeggiante che incarna l'ambizione e l'inganno." },
            { name: "Fusione Marchiata", image: "https://images.ygoprodeck.com/images/cards/44362883.jpg", chapterId: 3, lore: "Due forze opposte collidono. Ghiaccio e Fuoco, Passato e Futuro, in una danza mortale che squarcia la realtà stessa." },
            { name: "Alba-Lenatus il Drago Abisso", image: "https://images.ygoprodeck.com/images/cards/3410461.jpg", chapterId: 3, lore: "Disperazione pura. Messo all'angolo, Albaz si fonde forzatamente con i draghi nemici pur di sopravvivere." },
            { name: "Perdita Marchiata", image: "https://images.ygoprodeck.com/images/cards/10065487.jpg", chapterId: 3, lore: "Il prezzo della vittoria è altissimo. Albaz vince, ma perde il controllo e viene separato da Ecclesia." },
            { name: "Dogmatikaturgia", image: "https://images.ygoprodeck.com/images/cards/42158279.jpg", chapterId: 3, lore: "Il rituale finale del Dogma. Una liturgia sacra per risvegliare l'orrore che giace dormiente." },
            { name: "Espulsione Marchiata", image: "https://images.ygoprodeck.com/images/cards/1041278.jpg", chapterId: 3, lore: "L'esilio definitivo. Il Marchio spazza via chi è rimasto indietro, ripulendo il palco per la tragedia finale." },
            { name: "Albaz il Cinereo", image: "https://images.ygoprodeck.com/images/cards/37683547.jpg", chapterId: 3, lore: "Il ragazzo è ridotto in cenere, ma non è distrutto. Il suo cuore è ancora puro, pronto a risorgere dalle braci." },
            // ATTO IV
            { name: "Therion \"Toro\" Ain", image: "https://images.ygoprodeck.com/images/cards_small/84332527.jpg", chapterId: 4, lore: "Il toro meccanico. Un guerriero che lotta con forza brutale nell'arena interstellare." },
            { name: "Therion \"Mietitore\" Fum", image: "https://images.ygoprodeck.com/images/cards_small/21727231.jpg", chapterId: 4, lore: "Il mietitore di ferro. Silenzioso e letale, la sua presenza è un presagio di morte meccanica." },
            { name: "Therion \"Duca\" Yul", image: "https://images.ygoprodeck.com/images/cards_small/57111330.jpg", chapterId: 4, lore: "Il duca della guerra. Un guerriero d'élite al servizio dell'Argyro System." },
            { name: "Therion \"Giglio\" Borea", image: "https://images.ygoprodeck.com/images/cards_small/83610035.jpg", chapterId: 4, lore: "La sentinella del vento. Veloce e agile, esplora i confini del mondo meccanico." },
            { name: "Therion \"Re\" Regulus", image: "https://images.ygoprodeck.com/images/cards_small/10604644.jpg", chapterId: 4, lore: "Il campione delle macchine. Si unisce alla lotta portando la forza bruta dei Therion." },
            { name: "Motivato dalla Tribù", image: "https://images.ygoprodeck.com/images/cards_small/90969892.jpg", chapterId: 4, lore: "L'energia di un'intera tribù si riversa nel campo di battaglia, dando forza agli eroi." },
            { name: "Springans Kitt", image: "https://images.ygoprodeck.com/images/cards_small/45484331.jpg", chapterId: 4, lore: "Genio della meccanica incontrato nel deserto di Golgonda. Trasforma rottami in armi e diventa subito amica di Ecclesia." },
            { name: "Discolosseo Therion", image: "https://images.ygoprodeck.com/images/cards_small/84792926.jpg", chapterId: 4, lore: "Nell'arena d'acciaio, gladiatori meccanici e fulmini viventi si scontrano. Un caos di energia pura pronto a essere imbrigliato." },
            { name: "Carica Therion", image: "https://images.ygoprodeck.com/images/cards_small/57285770.jpg", chapterId: 4, lore: "I Therion caricano! L'attacco di massa della flotta meccanica per rompere l'assedio di Despia." },
            { name: "Incrocio Therion", image: "https://images.ygoprodeck.com/images/cards_small/43270827.jpg", chapterId: 4, lore: "La convergenza dei Therion. Un attacco combinato che unisce i poteri dello zodiaco." },
            { name: "Rialzati Therion!", image: "https://images.ygoprodeck.com/images/cards_small/79775821.jpg", chapterId: 4, lore: "Non è ancora finita. Un guerriero si rialza per difendere il Colosseo e l'Argyro System." },
            { name: "Sistema Argyro Motore Infinito", image: "https://images.ygoprodeck.com/images/cards_small/21887075.jpg", chapterId: 4, lore: "Il cuore pulsante del Therion, un'intelligenza artificiale che alimenta sia i robot che gli Spright." },
            { name: "Spright Zampillo", image: "https://images.ygoprodeck.com/images/cards_small/15443125.jpg", chapterId: 4, lore: "La prima scintilla. L'inizio dell'insurrezione degli Spright contro i loro carcerieri." },
            { name: "Spright Blu", image: "https://images.ygoprodeck.com/images/cards_small/76145933.jpg", chapterId: 4, lore: "Piccoli spiriti del fulmine dal potere immenso. Forniscono energia alla resistenza." },
            { name: "Spright Getto", image: "https://images.ygoprodeck.com/images/cards_small/13533678.jpg", chapterId: 4, lore: "Veloce come un lampo. La piccola creatura vola per portare messaggi e rinforzi." },
            { name: "Spright Pixie", image: "https://images.ygoprodeck.com/images/cards_small/49928686.jpg", chapterId: 4, lore: "Piccoli schermi di energia che confondono il nemico, proteggendo le forze alleate." },
            { name: "Spright Rosso", image: "https://images.ygoprodeck.com/images/cards_small/75922381.jpg", chapterId: 4, lore: "Lo spirito ribelle. Un fulmine di rabbia rossa contro l'autorità del sistema Argyro." },
            { name: "Spright Carota", image: "https://images.ygoprodeck.com/images/cards_small/2311090.jpg", chapterId: 4, lore: "La risorsa imprevista. Una carta jolly nella manica della ribellione Spright." },
            { name: "Spright Esplosione Gamma", image: "https://images.ygoprodeck.com/images/cards_small/42431833.jpg", chapterId: 4, lore: "L'esplosione di energia compressa. Un attacco che spazza via i nemici meccanici." },
            { name: "Therion \"Imperatrice\" Alasia", image: "https://images.ygoprodeck.com/images/cards_small/48806195.jpg", chapterId: 4, lore: "L'imperatrice del metallo, che unisce le forze Therion contro la minaccia maggiore." },
            { name: "Therion Irregolare", image: "https://images.ygoprodeck.com/images/cards_small/75290703.jpg", chapterId: 4, lore: "Il ribelle tra le macchine. Un guerriero che combatte per la sua libertà." },
            { name: "Spright Elfa", image: "https://images.ygoprodeck.com/images/cards_small/27381364.jpg", chapterId: 4, lore: "Piccoli spiriti del fulmine dal potere immenso. Forniscono energia alla resistenza." },
            { name: "Gigantesco Spright", image: "https://images.ygoprodeck.com/images/cards_small/54498517.jpg", chapterId: 4, lore: "La forma più grande e potente degli Spright. Un tuono vivente che doma il caos." },
            { name: "Spright Distruttori", image: "https://images.ygoprodeck.com/images/cards_small/88836438.jpg", chapterId: 4, lore: "La distruzione del sistema. L'attacco finale che sconfigge il controllo di Argyro." },
            { name: "Incrocio Doppio Spright", image: "https://images.ygoprodeck.com/images/cards_small/68250822.jpg", chapterId: 4, lore: "Un attacco a tenaglia inaspettato. Le forze della luce e del fulmine lavorano insieme." },
            { name: "Spright Sprind", image: "https://images.ygoprodeck.com/images/cards_small/72329844.jpg", chapterId: 4, lore: "Il piccolo Sprind si unisce alla battaglia, volando velocemente sopra il caos." },
            // ATTO V
            { name: "Marchiato nella Dogmatika Centrale", image: "https://images.ygoprodeck.com/images/cards_small/14220547.jpg", chapterId: 5, lore: "Il cuore nero del Dogma continua a battere. Ecclesia piange la perdita della guerriera, un tempo sua amica e mentore." },
            { name: "Le Virtuose Vestali", image: "https://www.cardtrader.com/uploads/blueprints/image/208220/show_the-virtuos-vestals-structure-deck-albaz-strike.jpg", chapterId: 5, lore: "La speranza persiste. Le anime delle Sante pure cercano di guidare i sopravvissuti attraverso le tenebre." },
            { name: "Bystial Magnamhut", image: "https://images.ygoprodeck.com/images/cards_small/33854624.jpg", chapterId: 5, lore: "Draghi antichi risvegliati per portare l'apocalisse. La loro fame è insaziabile." },
            { name: "Bystial Saronir", image: "https://images.ygoprodeck.com/images/cards_small/60242223.jpg", chapterId: 5, lore: "Draghi antichi risvegliati per portare l'apocalisse. La loro fame è insaziabile." },
            { name: "Bystial Druiswurm", image: "https://images.ygoprodeck.com/images/cards_small/6637331.jpg", chapterId: 5, lore: "Draghi antichi risvegliati per portare l'apocalisse. La loro fame è insaziabile." },
            { name: "Fiammeggiante Cartesia, la Virtuosa", image: "https://images.ygoprodeck.com/images/cards_small/95515789.jpg", chapterId: 5, lore: "La tragedia suprema. Il corpo di Ecclesia, vuoto e corrotto, diventa una marionetta di Aluber. Albaz deve combattere il suo amore." },
            { name: "Marchiato Riconquistato", image: "https://images.ygoprodeck.com/images/cards_small/34090915.jpg", chapterId: 5, lore: "Non tutto è perduto. La speranza ritorna, rianimando i marchi e le alleanze." },
            { name: "Granguignol il Drago del Crepuscolo", image: "https://images.ygoprodeck.com/images/cards_small/24915933.jpg", chapterId: 5, lore: "La fusione sacrilega di Cartesia. Un drago santo distorto dall'oscurità." },
            { name: "Bystial Baldrake", image: "https://images.ygoprodeck.com/images/cards_small/72656408.jpg", chapterId: 5, lore: "Il messaggero dei Bystial. Un drago leale che combatte per l'Abisso." },
            { name: "Bestia Marchiata", image: "https://images.ygoprodeck.com/images/cards_small/32756828.jpg", chapterId: 5, lore: "Il marchio della bestia. Un simbolo di potere e distruzione che si diffonde sul campo di battaglia." },
            { name: "Battaglia Decisiva di Golgonda", image: "https://images.ygoprodeck.com/images/cards_small/70485614.jpg", chapterId: 5, lore: "L'apice del conflitto: l'ultima, titanica battaglia nel deserto di Golgonda che decide il destino del mondo." },
            { name: "Il Drago Abisso Spadanima", image: "https://images.ygoprodeck.com/images/cards_small/5141117.jpg", chapterId: 5, lore: "Un drago sinuoso forgiato dalle anime degli Spadanima, pronto a vendicare il loro tradimento." },
            { name: "Il Bystial Alba Los", image: "https://images.ygoprodeck.com/images/cards_small/69120785.jpg", chapterId: 5, lore: "Il drago della rovina. La fusione finale e mostruosa di Alba Zoa, la massima espressione del Dogma." },
            { name: "Il Bystial Lubellion", image: "https://images.ygoprodeck.com/images/cards_small/32731036.jpg", chapterId: 5, lore: "La vera forma draconica di Aluber. Un divoratore di luce che guida l'assalto finale." },
            { name: "Tri-Brigata Mercourier", image: "https://images.ygoprodeck.com/images/cards_small/19096726.jpg", chapterId: 5, lore: "La guida. L'uccello meccanico di Shuraig ritorna per aiutare gli eroi a trovare la via d'uscita." },
            { name: "Scontro Finale Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards_small/7889323.jpg", chapterId: 5, lore: "La resa dei conti. I guerrieri combattono fianco a fianco, per l'ultima volta." },
            { name: "Dogmatikamatrice", image: "https://images.ygoprodeck.com/images/cards_small/35569555.jpg", chapterId: 5, lore: "Il meccanismo del Dogma si riattiva, minacciando di annientare tutte le creature che si oppongono al suo volere." },
            { name: "Dogmatika Alba Zoa", image: "https://images.ygoprodeck.com/images/cards_small/51522296.jpg", chapterId: 5, lore: "L'apoteosi del delirio nato improvvisamente dal contorto teatro Dispia. Un falso dio fatto di dogmi distorti si erge per divorare la luce e riscrivere l'esistenza a sua immagine." },
            { name: "Ghiacciogiada Creazione Aegirocassis", image: "https://images.ygoprodeck.com/images/cards_small/1295442.jpg", chapterId: 5, lore: "Un guscio di cristallo costruito dal dolore di Aegirine, armato per la battaglia finale." },
            { name: "Ghiacciogiada Gymir Aegirine", image: "https://images.ygoprodeck.com/images/cards_small/86682165.jpg", chapterId: 5, lore: "La nuova regina del ghiaccio. Mossa da un sentimento antico, combatte i nemici con il potere purificatore dell'acqua." },
            { name: "Manifestazione Ghiacciogiada", image: "https://images.ygoprodeck.com/images/cards_small/72776252.jpg", chapterId: 5, lore: "Il potere del ghiaccio si manifesta. Una forza gelida che si oppone alle fiamme della Despia." },
            { name: "Tally-ho! Springans", image: "https://images.ygoprodeck.com/images/cards_small/9175957.jpg", chapterId: 5, lore: "Fuochi d'artificio contro il destino! Quando tutto sembra perduto, la cavalleria arriva con un boato assordante ed esplosivo." },
            { name: "Tuonincrocio Gigante", image: "https://images.ygoprodeck.com/images/cards_small/34047456.jpg", chapterId: 5, lore: "Il potere combinato di Sargas e degli Spright. Un fulmine di energia pura che spezza l'armatura nemica." },
            { name: "Tri-Brigata", image: "https://www.cardtrader.com/uploads/blueprints/image/208219/show_tri-brigade-structure-deck-albaz-strike.jpg", chapterId: 5, lore: "I simboli della fratellanza. La prova che la resistenza non è mai morta." },
            { name: "Gigantesco \"Campione\" Sargas", image: "https://images.ygoprodeck.com/images/cards_small/11132674.jpg", chapterId: 5, lore: "Il capitano diventa leggenda. Armato della forza degli antichi e del fuoco dell'amicizia, guida la carica per spezzare l'assedio." },
            { name: "Rindbrumm il Drago Fragoroso", image: "https://images.ygoprodeck.com/images/cards_small/51409648.jpg", chapterId: 5, lore: "Un drago di luce e oscurità. La forza inaspettata che protegge i sopravvissuti nella battaglia finale." },
            { name: "Tri-Brigata Armi Bucephalus II", image: "https://images.ygoprodeck.com/images/cards_small/10019086.jpg", chapterId: 5, lore: "L'arma definitiva della Tri-Brigade. Un mostro meccanico forgiato per la massima distruzione." },
            { name: "Accadimento Marchiato", image: "https://images.ygoprodeck.com/images/cards_small/60442460.jpg", chapterId: 5, lore: "Il crollo. Le forze di Despia iniziano a cadere, segnando l'imminente fine del loro spettacolo." },
            { name: "Luce del Marchiato", image: "https://images.ygoprodeck.com/images/cards_small/72554664.jpg", chapterId: 5, lore: "Un flash accecante che cancella le ombre. La volontà indomita di vivere sferra il colpo finale, spezzando per sempre il ciclo del dolore." },
            { name: "Il Re più Luminoso, Fiammeggiante, Marchiato", image: "https://images.ygoprodeck.com/images/cards_small/19271881.jpg", chapterId: 5, lore: "Il vero re. Un'entità di luce pura che unisce i frammenti della speranza in una sola fiamma trionfante." },
            { name: "Bystial Dis Pater", image: "https://images.ygoprodeck.com/images/cards_small/27572350.jpg", chapterId: 5, lore: "Dalle profondità dell'Abisso, i veri padri si risvegliano. Titani antichi reclamano il mondo, schiacciando la speranza sotto la loro ombra." },
            { name: "Albion Il Drago Santifuoco", image: "https://images.ygoprodeck.com/images/cards_small/38811586.jpg", chapterId: 5, lore: "Due cuori, una sola fiamma. L'unione che trascende la carne e purifica l'oscurità con il fuoco bianco della verità assoluta." },
            { name: "Luluwalilith Dispiana", image: "https://images.ygoprodeck.com/images/cards_small/53971455.jpg", chapterId: 5, lore: "La luce della speranza che rinasce dalle ceneri di Fleurdelis per proteggere i suoi amici un'ultima volta." },
            { name: "Punizione Spadanima", image: "https://images.ygoprodeck.com/images/cards_small/83308376.jpg", chapterId: 5, lore: "La giustizia degli Spadanima è compiuta: il traditore riceve la sua meritata punizione." },
            { name: "Ruggito Tri-Brigata", image: "https://images.ygoprodeck.com/images/cards_small/10793085.jpg", chapterId: 5, lore: "Il ruggito della vittoria. La Tri-Brigade celebra la fine della tirannia con un grido di libertà." },
            { name: "Studio del Marchiato", image: "https://images.ygoprodeck.com/images/cards_small/45675980.jpg", chapterId: 5, lore: "Il momento decisivo. La luce di Albaz spezza le catene di Cartesia. Aluber è sconfitto." },
            { name: "Batter d'Occhio", image: "https://images.ygoprodeck.com/images/cards_small/28279365.jpg", chapterId: 5, lore: "Un lampo e il nemico scompare. L'ultima resistenza di Aluber prima di fuggire dall'Abisso." },
            { name: "Caduto di Argyros", image: "https://images.ygoprodeck.com/images/cards_small/82090807.jpg", chapterId: 5, lore: "Un drago corrotto, parte del sistema Argyro. Il ricordo di una minaccia sconfitta, ma non eliminata." },
            { name: "Ghiacciogiada Ran Aegirine", image: "https://images.ygoprodeck.com/images/cards_small/18494511.jpg", chapterId: 5, lore: "La nuova Regina ha preso il suo posto. Il suo regno è ora protetto dal suo dolore e dal suo potere." },
            { name: "Prigione di Ghiaccio Milione di Secoli", image: "https://images.ygoprodeck.com/images/cards_small/23746827.jpg", chapterId: 5, lore: "Una prigione di cristallo creata per sigillare i poteri oscuri e farli dormire per milioni di anni." },
            { name: "Guida Quem, la Virtuosa", image: "https://images.ygoprodeck.com/images/cards_small/45883110.jpg", chapterId: 5, lore: "La prima Santa. Uno spirito che osserva ridendo la fine del ciclo, custode delle memorie perdute." },
            { name: "Il Bystial Aluber", image: "https://images.ygoprodeck.com/images/cards_small/45005708.jpg", chapterId: 5, lore: "Aluber il Caduto: un'ultima, beffarda apparizione che suggerisce che la tragedia non è finita." },
            { name: "La Capra Nera Ride", image: "https://images.ygoprodeck.com/images/cards_small/49299410.jpg", chapterId: 5, lore: "La risata dell'entità cosmica. Il vero dio dell'Abisso osserva gli eventi, aspettando il suo momento." },
            { name: "Nuova Frontiera", image: "https://images.ygoprodeck.com/images/cards_small/56787189.jpg", chapterId: 5, lore: "La polvere si posa su un mondo cambiato. Le cicatrici restano, ma all'orizzonte non ci sono più muri, solo un cammino libero verso il domani." }
        ];

        // --- COMPONENTS ---
        const Card = ({ data, onClick }) => (
            <div 
                onClick={() => onClick(data)} 
                className="card-glow relative aspect-[2/3] rounded-lg overflow-hidden cursor-pointer transform transition-all duration-300 
                hover:scale-[1.02] active:scale-[1.02] 
                border border-slate-700 
                hover:border-yellow-500 active:border-yellow-500 
                bg-slate-900 group w-full h-full"
            >
                <img src={data.image} alt={data.name} className="w-full h-full object-cover" loading="lazy" />
                <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60 
                group-hover:opacity-40 group-active:opacity-40 transition-opacity" />
            </div>
        );

        const Modal = ({ card, onClose, onNext, onPrev, hasNext, hasPrev }) => {
            if (!card) return null;

            const [animClass, setAnimClass] = useState(''); 
            const [touchStart, setTouchStart] = useState(null);
            const [touchEnd, setTouchEnd] = useState(null);
            const [showFullImage, setShowFullImage] = useState(false); 
            const [fullImageAnim, setFullImageAnim] = useState('animate-zoomIn');

            useEffect(() => {
                document.body.style.overflow = 'hidden';
                return () => {
                    document.body.style.overflow = '';
                };
            }, []);

            const handleNextAnim = () => {
                setAnimClass('anim-exit-left');
                setTimeout(() => {
                    onNext();
                    setAnimClass('anim-enter-right');
                }, 180);
            };

            const handlePrevAnim = () => {
                setAnimClass('anim-exit-right');
                setTimeout(() => {
                    onPrev();
                    setAnimClass('anim-enter-left');
                }, 180);
            };

            const handleFullNext = () => {
                setFullImageAnim('anim-exit-left');
                setTimeout(() => {
                    onNext();
                    setFullImageAnim('anim-enter-right');
                }, 180);
            };

            const handleFullPrev = () => {
                setFullImageAnim('anim-exit-right');
                setTimeout(() => {
                    onPrev();
                    setFullImageAnim('anim-enter-left');
                }, 180);
            };

            const closeFullImage = (e) => {
                e?.stopPropagation();
                setFullImageAnim('animate-zoomOut');
                setTimeout(() => {
                    setShowFullImage(false);
                    setFullImageAnim('animate-zoomIn'); 
                }, 300);
            };

            const openFullImage = () => {
                setFullImageAnim('animate-zoomIn');
                setShowFullImage(true);
            };

            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (showFullImage) { 
                            if (e.key === 'Escape') closeFullImage();
                            if (e.key === 'ArrowLeft' && hasPrev) handleFullPrev();
                            if (e.key === 'ArrowRight' && hasNext) handleFullNext();
                            return;
                    }
                    
                    if (e.key === 'ArrowLeft' && hasPrev) handlePrevAnim();
                    if (e.key === 'ArrowRight' && hasNext) handleNextAnim();
                    if (e.key === 'Escape') onClose();
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [hasPrev, hasNext, onClose, showFullImage]); 

            const onTouchStartHandler = (e) => {
                setTouchEnd(null);
                setTouchStart(e.targetTouches[0].clientX);
            };
            const onTouchMoveHandler = (e) => setTouchEnd(e.targetTouches[0].clientX);
            const onTouchEndHandler = () => {
                if (!touchStart || !touchEnd) return;
                const distance = touchStart - touchEnd;
                const isLeftSwipe = distance > 50;
                const isRightSwipe = distance < -50;
                
                if (showFullImage) {
                    if (isLeftSwipe && hasNext) handleFullNext();
                    if (isRightSwipe && hasPrev) handleFullPrev();
                } else {
                    if (isLeftSwipe && hasNext) handleNextAnim();
                    if (isRightSwipe && hasPrev) handlePrevAnim();
                }
            };

            return (
                <>
                    <div 
                        onClick={(e) => e.target === e.currentTarget && onClose()} 
                        className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/95 backdrop-blur-sm animate-fadeIn"
                    >
                        {!showFullImage && hasPrev && (
                            <button 
                                onClick={(e) => { e.stopPropagation(); handlePrevAnim(); }}
                                className="absolute left-2 md:left-8 z-50 text-slate-400 hover:text-yellow-500 transition-colors p-2 bg-black/50 rounded-full hover:bg-black/80"
                            >
                                <Icons.Prev />
                            </button>
                        )}
                        {!showFullImage && hasNext && (
                            <button 
                                onClick={(e) => { e.stopPropagation(); handleNextAnim(); }}
                                className="absolute right-2 md:right-8 z-50 text-slate-400 hover:text-yellow-500 transition-colors p-2 bg-black/50 rounded-full hover:bg-black/80"
                            >
                                <Icons.Next />
                            </button>
                        )}

                        <div 
                            className={`relative w-full max-w-md bg-slate-900 rounded-xl border border-slate-700 shadow-2xl flex flex-col max-h-[85vh] ${animClass || 'animate-slideUp'}`}
                            onTouchStart={onTouchStartHandler}
                            onTouchMove={onTouchMoveHandler}
                            onTouchEnd={onTouchEndHandler}
                        >
                            <div className="flex justify-between items-center p-4 border-b border-slate-800 bg-slate-900/50 sticky top-0 z-10 rounded-t-xl">
                                <h3 className="text-[21px] font-bold text-yellow-500 pr-4 font-fantasy">{card.name}</h3>
                                <button onClick={onClose} className="text-slate-400 hover:text-white p-1 transition-colors"><Icons.Close /></button>
                            </div>
                            <div className="flex-1 flex flex-col items-center overflow-hidden p-4">
                                <div className="flex-1 w-full flex items-center justify-center min-h-0 mb-4">
                                    <div 
                                        onClick={openFullImage}
                                        className="aspect-square h-full max-h-full max-w-full overflow-hidden rounded-lg shadow-[0_0_30px_rgba(0,0,0,0.5)] border border-slate-800 relative cursor-zoom-in group"
                                    >
                                        <img 
                                            src={getHighResUrl(card.image) || card.image} 
                                            alt={card.name} 
                                            className="w-full h-full object-cover object-[50%_25%] scale-110 transition-transform duration-700 group-hover:scale-115" 
                                        />
                                    </div>
                                </div>
                                <div className="shrink-0 w-full bg-slate-800/30 p-5 rounded-lg border border-slate-700/30 relative">
                                    <div className="absolute -top-3 left-4 bg-slate-900 px-2 text-yellow-600 text-xs uppercase font-bold tracking-widest border border-slate-700 rounded-full flex items-center gap-1">
                                        <Icons.Sparkles /> Lore
                                    </div>
                                    <p className="text-slate-300 italic leading-relaxed font-serif text-center text-lg">"{card.lore}"</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    {showFullImage && (
                        <div 
                            onClick={closeFullImage}
                            className="fixed inset-0 z-[60] flex items-center justify-center bg-black/95 backdrop-blur-md animate-fadeIn cursor-zoom-out"
                            onTouchStart={onTouchStartHandler}
                            onTouchMove={onTouchMoveHandler}
                            onTouchEnd={onTouchEndHandler}
                        >
                            <button 
                                onClick={closeFullImage} 
                                className="absolute top-4 right-4 text-white/70 hover:text-white p-2 bg-black/50 rounded-full z-[70]"
                            >
                                <Icons.Close />
                            </button>
                            <div className={`relative w-full h-full flex items-center justify-center p-4 ${fullImageAnim}`}>
                                <img 
                                    src={getHighResUrl(card.image) || card.image} 
                                    alt={card.name} 
                                    className="max-w-full max-h-full object-contain shadow-2xl rounded-lg" 
                                />
                            </div>
                        </div>
                    )}
                </>
            );
        };

        const App = () => {
            const [view, setView] = useState('home');
            const [actTab, setActTab] = useState('album'); 
            const [chapterId, setChapterId] = useState(null);
            const [selectedCard, setSelectedCard] = useState(null);
            const [showHeroText, setShowHeroText] = useState(true);
            const [installPrompt, setInstallPrompt] = useState(null);
            const [chapterAnim, setChapterAnim] = useState('');
            
            // --- NUOVI STATI PER ZOOM IMMAGINE CAPITOLO ---
            const [showFullChapterImage, setShowFullChapterImage] = useState(false);
            const [chapterFullImageAnim, setChapterFullImageAnim] = useState('animate-zoomIn');

            const currentChapter = useMemo(() => chaptersData.find(c => c.id === chapterId), [chapterId]);
            const currentCards = useMemo(() => cardsData.filter(c => c.chapterId === chapterId), [chapterId]);

            const currentIndex = useMemo(() => currentCards.findIndex(c => c.name === selectedCard?.name), [currentCards, selectedCard]);
            const hasPrev = currentIndex > 0;
            const hasNext = currentIndex < currentCards.length - 1;

            useEffect(() => {
                const handleBeforeInstallPrompt = (e) => {
                    e.preventDefault();
                    setInstallPrompt(e);
                };
                window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                return () => window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
            }, []);

            const handleInstallClick = () => {
                if (!installPrompt) return;
                installPrompt.prompt();
                installPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        setInstallPrompt(null);
                    }
                });
            };

            useEffect(() => {
                const handlePopState = (event) => {
                    if (selectedCard) {
                        setSelectedCard(null);
                    } else if (view === 'album') {
                        setView('home');
                        setChapterId(null);
                    }
                };
                window.addEventListener('popstate', handlePopState);
                return () => window.removeEventListener('popstate', handlePopState);
            }, [view, selectedCard]);

            useEffect(() => {
                setShowHeroText(true);
                // Rimosso setActTab('album') per mantenere la tab corrente al cambio capitolo
            }, [chapterId]);

            const handleNext = () => {
                if (hasNext) setSelectedCard(currentCards[currentIndex + 1]);
            };

            const handlePrev = () => {
                if (hasPrev) setSelectedCard(currentCards[currentIndex - 1]);
            };

            const openChapter = (id) => { 
                window.history.pushState({ page: 'album' }, '', '');
                setChapterId(id); 
                setView('album'); 
                window.scrollTo(0,0); 
            };

            const handleNextChapter = () => {
                if (chapterId < chaptersData.length) {
                    setChapterAnim('anim-exit-left');
                    setTimeout(() => {
                        setChapterId(prev => prev + 1);
                        setChapterAnim('anim-enter-right');
                        window.scrollTo(0, 0);
                    }, 180);
                }
            };

            const handlePrevChapter = () => {
                if (chapterId > 1) {
                    setChapterAnim('anim-exit-right');
                    setTimeout(() => {
                        setChapterId(prev => prev - 1);
                        setChapterAnim('anim-enter-left');
                        window.scrollTo(0, 0);
                    }, 180);
                }
            };

            const openCard = (card) => {
                window.history.pushState({ page: 'modal' }, '', '');
                setSelectedCard(card);
            };

            const goBack = () => {
                window.history.back();
            };

            // --- NUOVE FUNZIONI PER APERTURA IMMAGINE CAPITOLO ---
            const openChapterFullImage = () => {
                setChapterFullImageAnim('animate-zoomIn');
                setShowFullChapterImage(true);
            };

            const closeChapterFullImage = (e) => {
                e?.stopPropagation();
                setChapterFullImageAnim('animate-zoomOut');
                setTimeout(() => {
                    setShowFullChapterImage(false);
                    setChapterFullImageAnim('animate-zoomIn');
                }, 300);
            };

            return (
                <div className="min-h-screen w-full max-w-md mx-auto bg-slate-950 shadow-2xl flex flex-col relative border-x border-slate-900/50">
                    <nav className="sticky top-0 z-40 bg-slate-950/80 backdrop-blur-md border-b border-slate-800/50 px-4 h-14 flex items-center justify-between">
                        {view === 'album' ? (
                            <>
                                <button onClick={goBack} className="flex items-center gap-1 text-yellow-500 hover:text-yellow-400 transition-colors font-bold font-fantasy tracking-wide text-sm">
                                    <Icons.Back /> INDICE
                                </button>
                                <button 
                                    onClick={() => setShowHeroText(!showHeroText)}
                                    className="text-slate-400 hover:text-white transition-colors p-2"
                                >
                                    {showHeroText ? <Icons.EyeOff /> : <Icons.Eye />}
                                </button>
                            </>
                        ) : (
                            <div className="flex items-center justify-between w-full">
                                <span className="text-slate-200 font-bold font-fantasy tracking-wider text-lg">STORIA DELL'ABISSO</span>
                                {installPrompt && (
                                    <button 
                                        onClick={handleInstallClick}
                                        className="flex items-center gap-1 bg-yellow-600 text-slate-950 text-xs font-bold px-2 py-1 rounded hover:bg-yellow-500 transition-colors animate-pulse"
                                    >
                                        <Icons.Download /> APP
                                    </button>
                                )}
                            </div>
                        )}
                    </nav>

                    <main className="flex-1 p-4 overflow-x-hidden">
                        {view === 'home' && (
                            <div className="space-y-6 animate-fadeIn">
                                <div className="text-center pt-2 pb-6 space-y-2">
                                    <h1 className="text-3xl text-yellow-600 font-fantasy">Cronache del Caduto e della Virtuosa</h1>
                                    <p className="text-slate-200 text-sm italic">"Rivela gli Atti e scopri la verità perduta"</p>
                                </div>

                                <div className="grid gap-6 animate-slideUp">
                                    {chaptersData.map(chapter => (
                                        <div 
                                            key={chapter.id} 
                                            onClick={() => openChapter(chapter.id)} 
                                            className="group relative bg-slate-900 rounded-xl overflow-hidden border border-slate-800 shadow-lg cursor-pointer transition-all hover:border-yellow-600/50 active:scale-95"
                                        >
                                            <div className="h-32 w-full overflow-hidden relative">
                                                <div className="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10" />
                                                <img 
                                                    src={chapter.cover} 
                                                    alt={chapter.title}
                                                    className="w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700"
                                                />
                                            </div>
                                            <div className="p-5 relative z-20 -mt-4">
                                                <h2 className="text-xl font-bold text-white leading-tight mb-2 font-fantasy">{chapter.fullTitle}</h2>
                                                <p className="text-slate-400 text-xs line-clamp-2 font-serif italic whitespace-pre-line">
                                                    {chapter.story}
                                                </p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {view === 'album' && currentChapter && (
                            <div className={`pb-10 ${chapterAnim || 'animate-slideUp'}`}>
                                <div className="relative mb-6 rounded-xl border border-slate-700 overflow-hidden text-center shadow-2xl">
                                     <div 
                                        className={`absolute inset-0 bg-cover bg-center transition-all duration-700 ${!showHeroText ? 'cursor-zoom-in' : ''}`}
                                        style={{ backgroundImage: `url(${currentChapter.cover})` }}
                                        onClick={() => !showHeroText && openChapterFullImage()}
                                     />
                                     <div className={`absolute inset-0 bg-slate-950/80 backdrop-blur-[1px] transition-opacity duration-700 ${showHeroText ? 'opacity-100' : 'opacity-0 pointer-events-none'}`} />
                                     
                                     {/* Removed Eye button from here */}

                                     {/* FRECCE NAVIGAZIONE CAPITOLI */}
                                     {chapterId > 1 && (
                                        <button 
                                            onClick={(e) => { e.stopPropagation(); handlePrevChapter(); }}
                                            className="absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center z-30 text-white/70 hover:text-white bg-black/40 hover:bg-black/60 transition-all backdrop-blur-sm rounded-full"
                                        >
                                            <Icons.Prev />
                                        </button>
                                     )}
                                     {chapterId < chaptersData.length && (
                                        <button 
                                            onClick={(e) => { e.stopPropagation(); handleNextChapter(); }}
                                            className="absolute right-1 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center z-30 text-white/70 hover:text-white bg-black/40 hover:bg-black/60 transition-all backdrop-blur-sm rounded-full"
                                        >
                                            <Icons.Next />
                                        </button>
                                     )}

                                     <div 
                                        className={`relative z-10 p-6 transition-opacity duration-700 pointer-events-none ${showHeroText ? 'opacity-100' : 'opacity-0'}`}
                                     >
                                         <h2 className="text-2xl text-yellow-500 font-fantasy mb-3 drop-shadow-lg">{currentChapter.fullTitle}</h2>
                                         <div className="h-px w-20 bg-gradient-to-r from-transparent via-yellow-600 to-transparent mx-auto mb-4"></div>
                                         <p className="text-slate-200 text-sm italic font-serif whitespace-pre-line leading-relaxed drop-shadow-md">
                                             {currentChapter.story}
                                         </p>
                                     </div>
                                </div>

                                {/* TAB NAVIGATION */}
                                <div className="flex p-0.5 bg-slate-900/50 rounded-lg border border-slate-800/50 mb-6">
                                    <button 
                                        onClick={() => setActTab('album')}
                                        className={`flex-1 flex items-center justify-center gap-2 py-1.5 rounded-md transition-all font-bold text-xs tracking-wide ${actTab === 'album' ? 'bg-yellow-600 text-slate-950 shadow-lg' : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800'}`}
                                    >
                                        <Icons.Book /> ALBUM
                                    </button>
                                    <button 
                                        onClick={() => setActTab('anime')}
                                        className={`flex-1 flex items-center justify-center gap-2 py-1.5 rounded-md transition-all font-bold text-xs tracking-wide ${actTab === 'anime' ? 'bg-yellow-600 text-slate-950 shadow-lg' : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800'}`}
                                    >
                                        <Icons.Tv /> ANIME
                                    </button>
                                </div>

                                {actTab === 'album' && (
                                    currentCards.length > 0 ? (
                                        <div className="grid grid-cols-3 border-t border-l border-dashed border-slate-700/50 bg-slate-900/30 rounded-lg overflow-hidden animate-fadeIn">
                                            {currentCards.map((card, idx) => (
                                                <div key={idx} className="border-r border-b border-dashed border-slate-700/50 p-2 flex items-center justify-center">
                                                    <Card data={card} onClick={openCard} />
                                                </div>
                                            ))}
                                        </div>
                                    ) : (
                                        <div className="text-center py-16 border border-dashed border-slate-800 rounded-xl bg-slate-900/20 animate-fadeIn"><p class="text-slate-500">Nessuna memoria trovata.</p></div>
                                    )
                                )}

                                {actTab === 'anime' && (
                                    currentChapter.comingSoon ? (
                                        <div className="mt-8 animate-fadeIn text-center p-6 border border-dashed border-slate-800 rounded-lg bg-slate-900/30">
                                             <h3 className="text-xl text-slate-500 font-fantasy mb-2 flex items-center justify-center gap-2">
                                                <Icons.Video /> In Arrivo
                                            </h3>
                                        </div>
                                    ) : currentChapter.videos && currentChapter.videos.length > 0 ? (
                                        <div className="grid gap-6 animate-fadeIn">
                                            {currentChapter.videos.map((video, idx) => {
                                                const videoId = getYoutubeId(video.url);
                                                const thumbUrl = getYoutubeThumbnail(videoId);
                                                return (
                                                    <a 
                                                        key={idx}
                                                        href={video.url}
                                                        target="_blank"
                                                        rel="noopener noreferrer"
                                                        className="relative group bg-slate-900/50 border border-slate-800 rounded-lg overflow-hidden hover:border-yellow-600/50 cursor-pointer transition-all block shadow-lg"
                                                    >
                                                        <div className="relative aspect-video w-full overflow-hidden">
                                                            <img src={thumbUrl} alt={video.title} className="w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700" />
                                                            <div className="absolute inset-0 bg-black/40 flex items-center justify-center group-hover:bg-black/20 transition-colors">
                                                                <div className="w-14 h-14 bg-red-600/90 rounded-full flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-transform">
                                                                    <Icons.Play />
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="p-3 bg-slate-900 border-t border-slate-800">
                                                            <h4 className="text-slate-200 font-bold text-sm group-hover:text-yellow-500 transition-colors line-clamp-2">{video.title}</h4>
                                                        </div>
                                                    </a>
                                                );
                                            })}
                                        </div>
                                    ) : (
                                        <div className="text-center py-16 border border-dashed border-slate-800 rounded-xl bg-slate-900/20 animate-fadeIn">
                                            <p className="text-slate-500">Nessun video disponibile.</p>
                                        </div>
                                    )
                                )}
                            </div>
                        )}
                        
                        {/* FULL SCREEN CHAPTER IMAGE OVERLAY */}
                        {showFullChapterImage && currentChapter && (
                            <div 
                                onClick={closeChapterFullImage}
                                className="fixed inset-0 z-[60] flex items-center justify-center bg-black/95 backdrop-blur-md animate-fadeIn cursor-zoom-out"
                            >
                                <button 
                                    onClick={closeChapterFullImage} 
                                    className="absolute top-4 right-4 text-white/70 hover:text-white p-2 bg-black/50 rounded-full z-[70]"
                                >
                                    <Icons.Close />
                                </button>
                                <div className={`relative w-full h-full flex items-center justify-center p-4 ${chapterFullImageAnim}`}>
                                    <img 
                                        src={currentChapter.cover} 
                                        alt={currentChapter.title} 
                                        className="max-w-full max-h-full object-contain shadow-2xl rounded-lg" 
                                    />
                                </div>
                            </div>
                        )}

                    </main>
                    {selectedCard && (
                        <Modal 
                            card={selectedCard} 
                            onClose={goBack}
                            onNext={handleNext}
                            onPrev={handlePrev}
                            hasNext={hasNext}
                            hasPrev={hasPrev}
                        />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
                .then(() => console.log('Service Worker registrato!'))
                .catch((err) => console.log('Errore SW:', err));
        }
    </script>
</body>


</html>